---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

## Overview of `MRFcov`

The `MRFcov` package provides functions for approximating node interaction parameters of undirected Markov Random Fields graphs. Models can incorporate covariates (following methods developed by Cheng **et al** 2014 and Lindberg 2016), allowing users to estimate how interactions between nodes in the graph are predicted to change across covariate gradients

## Installation

You can install `MRFcov` into `R` directly from `GitHub` using:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("nicholasjclark/MRFcov")
```

## Usage

Markov random fields interaction parameters are approximated using separate regressions for individual nodes (species) within a joint modelling framework. Because all combinations of covariates and additional nodes are included as predictor variables in regressions for each individual node, variable selection is required to reduce overfitting and add sparsity. This is accomplished through LASSO penalization using functions in the [penalized package](https://cran.r-project.org/web/packages/penalized/index.html)  
  
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(MRFcov)
```

Load the Bird.parasites dataset
```{r}
data("Bird.parasites")
```

Visualise the dataset to see how analysis data needs to be structured. In short, node variable (i.e. species) occurrences need to included as binary variables (1s and 0s) as the left-most variables in the `data`. Any covariates can be included as the right-most variables. Note, these covariates should all be on a similar scale, ideally using the `scale` function for continuous covariates (or similar)
```{r eval=FALSE}
help("Bird.parasites")
View(Bird.parasites)
```

Run an MRF model using a single continuous covariate (scale.prop.zos). Here w and a weak penalization parameter (`lambda1`) for LASSO variable selection
```{r}
MRF_mod <- MRFcov(data = Bird.parasites, n_nodes = 4, lambda1 = 1)
```

Plot the estimated species interaction coefficients
```{r fig.align = "center",fig.height=4,fig.width=4,message=FALSE}
plotMRF_hm(MRF_mod = MRF_mod)
```

Visualise how species interactions change across covariate magnitudes
```{r fig.align = "center",fig.height=5,fig.width=5,message=FALSE}
plotMRF_hm_cont(MRF_mod = MRF_mod, covariate = 'scale.prop.zos', data = Bird.parasites, 
                main = 'Estimated interactions across host relative densities')
```

## References
Cheng, J., Levina, E., Wang, P. & Zhu, J. (2014). A sparse Ising model with covariates. Biometrics, 70, 943-953  
  
Lindberg, O. (2016). Markov Random Fields in Cancer Mutation Dependencies. Master's of Science Thesis. University of Turku, Turku, Finland.
